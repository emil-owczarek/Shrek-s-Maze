import{initializeApp as x}from"https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";import{getFirestore as A,doc as z,collection as L,setDoc as q,query as H,orderBy as R,limit as B,getDocs as D}from"https://www.gstatic.com/firebasejs/10.6.0/firebase-firestore.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function r(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(o){if(o.ep)return;o.ep=!0;const n=r(o);fetch(o.href,n)}})();const O={apiKey:"AIzaSyDMMr4pNlvym9tNaDzMeLGkc_6z3cXQ4RI",authDomain:"shrek-s-maze-59835.firebaseapp.com",projectId:"shrek-s-maze-59835",storageBucket:"shrek-s-maze-59835.appspot.com",messagingSenderId:"830984947424",appId:"1:830984947424:web:b268b898f6b9e8c6503285",measurementId:"G-GQMS0WZT37"},N=x(O),I=A(N);let p="start",l=1,d=0,a=0,y;const u=document.querySelector(".maze"),b=document.querySelectorAll(".maze__wall"),w=document.querySelector(".modal"),k=document.querySelector(".maze__audioplayer"),m=document.querySelector(".maze__start"),h=document.querySelector(".maze__finish"),v=document.querySelector(".maze__wall--2"),C=document.querySelector(".modal__title"),i=document.querySelector(".modal__button"),f=document.getElementById("tens"),g=document.getElementById("seconds"),P=document.querySelector(".modal__button--scoreboard"),$=document.querySelector(".scoreboard-modal__close-button"),S=document.querySelector(".scoreboard-modal"),G={level1:{1:"1 / 1 / 7 / 3",2:"4 / 3 / 7 / 5",3:"2 / 6 / 8 / 8",4:"2 / 4 / 3 / 6"},level2:{2:"1 / 5 / 6 / 8",1:"1 / 8 / 4 / 9",3:"3 / 9 / 4 / 10",4:"5 / 9 / 11 / 11",5:"6 / 7 / 10 / 8",6:"2 / 3 / 11 / 4",7:"7 / 4 / 8 / 6",8:"1 / 1 / 5 / 2",9:"6 / 2 / 9 / 3",10:"9 / 5 / 10 / 7"},level3:{1:"18 / 4 / 19 / 7",2:"13 / 1 / 18 / 7",3:"1 / 1 / 13 / 3",4:"20 / 4 / 21 / 9",5:"1 / 3 / 3 / 18",6:"10 / 8 / 20 / 9",7:"10 / 4 / 12 / 8",8:"4 / 4 / 10 / 5",9:"4 / 5 / 5 / 16",10:"15 / 9 / 18 / 13",11:"14 / 10 / 15 / 13",12:"6 / 6 / 7 / 17",13:"8 / 6 / 9 / 17",14:"3 / 17 / 19 / 18",15:"10 / 10 / 13 / 16",16:"19 / 10 / 20 / 19",17:"14 / 14 / 18 / 17",18:"6 / 20 / 21 / 21",19:"9 / 18 / 18 / 19",20:"4 / 19 / 6 / 21"}},_={1:{gridColsRows:"repeat(7, 1fr)",background:"url('./assets/images/castle.webp')",pathColor:"#723305",wallsColor:"rgba(80, 5, 5, 0.822)",startArea:"7 / 1 / 8 / 2",finishArea:"1 / 7 / 2 / 8",startIcon:"url('./assets/images/dragon.webp')",finishIcon:"url('./assets/images/donkey.webp')",audioSource:"./assets/sounds/level1.mp3"},2:{gridColsRows:"repeat(10, 1fr)",background:"url('./assets/images/swamp.webp')",pathColor:"#aa5e27",wallsColor:"rgb(13, 83, 4)",startArea:"9 / 1 / 11 / 3",finishArea:"1 / 9 / 3 / 11",startIcon:"url('./assets/images/donkey.webp')",finishIcon:"url('./assets/images/shrek.webp')",audioSource:"./assets/sounds/level2.mp3"},3:{gridColsRows:"repeat(20, 1fr)",background:"url('./assets/images/far-far-away.webp')",wallsColor:"#2d303d",startArea:"18 / 1 / 21 / 4",finishArea:"1 / 18 / 4 / 21",startIcon:"url('./assets/images/shrek.webp')",finishIcon:"url('./assets/images/fiona.webp')",audioSource:"./assets/sounds/level3.mp3"}};E(1);T();i.addEventListener("click",()=>{l===1?v.textContent="Click the Dragon to start the game":v.textContent="",(i.textContent==="Play Again"||i.textContent==="Yeyy, play again")&&(clearInterval(y),a=0,d=0,f.innerHTML="00",g.innerHTML="00",l=1),w.style.display="none",E(l)});u.addEventListener("mouseleave",M);b.forEach(t=>{t.addEventListener("mouseover",M)});m.addEventListener("click",()=>{p="go",m.textContent="GO!",setTimeout(()=>{m.textContent="",v.textContent=""},1e3),clearInterval(y),y=setInterval(j,10)});h.addEventListener("mouseover",()=>{p==="go"&&(p="finished",k.src=_[l].audioSource,k.play(),W(l),clearInterval(y),w.style.display="block")});P.addEventListener("click",()=>{S.style.display="block"});$.addEventListener("click",()=>{S.style.display="none"});document.addEventListener("contextmenu",function(t){t.preventDefault()});document.addEventListener("keydown",function(t){t.key==="F12"&&(t.preventDefault(),alert("Use of developer tools is blocked on this page."))});function E(t){const e=_[t];document.body.style.backgroundImage=e.background,u.style.backgroundColor=e.pathColor,u.style.gridTemplateColumns=e.gridColsRows,u.style.gridTemplateRows=e.gridColsRows,b.forEach(r=>{r.style.backgroundColor=e.wallsColor}),m.style.gridArea=e.startArea,m.style.backgroundImage=e.startIcon,h.style.gridArea=e.finishArea,h.style.backgroundImage=e.finishIcon,F(t)}function F(t){const e=G[`level${t}`];b.forEach(r=>{r.style.display="none"}),Object.keys(e).forEach(r=>{const s=document.querySelector(`.maze__wall--${r}`);s&&(s.style.display="block",s.style.gridArea=e[r])})}function M(){p==="go"&&(b.forEach(t=>{t.style.backgroundColor="#bf0000"}),setTimeout(()=>{p="start",u.classList.remove("dead"),l=1},500),w.style.display="block",C.textContent="Shrek's Maze",i.textContent="Play Again",l=1,clearInterval(y))}function W(t){if(t<3)C.textContent="Good Job",i.textContent="Next Level",l++;else{C.textContent="You won",i.textContent="Yeyy, play again";let e=prompt("Congratulations! Enter your name (max 13 characters):");if(e){e=e.substring(0,13);const r=`${g.innerHTML}:${f.innerHTML}`;Y(e,r),T()}}}function Y(t,e){const r=z(L(I,"scores"));q(r,{name:t,time:e}).then(()=>{}).catch(s=>{console.error("Error adding score: ",s)})}function T(){const t=H(L(I,"scores"),R("time","asc"),B(5));D(t).then(e=>{const r=document.querySelector(".scoreboard-modal__content div");r.innerHTML="";for(let s=0;s<e.docs.length;s++){const n=e.docs[s].data(),c=document.createElement("p");c.className="scoreboard-modal__player-score",c.textContent=`${s+1}. ${n.name} - ${n.time}`,r.appendChild(c)}})}function j(){a++,a<=9&&(f.innerHTML="0"+a),a>9&&(f.innerHTML=a),a>99&&(d++,g.innerHTML="0"+d,a=0,f.innerHTML="00"),d>9&&(g.innerHTML=d)}
