import{initializeApp as M}from"https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";import{getFirestore as T,doc as x,collection as L,setDoc as A,query as R,orderBy as F,limit as H,getDocs as B}from"https://www.gstatic.com/firebasejs/10.6.0/firebase-firestore.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function r(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(o){if(o.ep)return;o.ep=!0;const s=r(o);fetch(o.href,s)}})();const D={apiKey:"AIzaSyDMMr4pNlvym9tNaDzMeLGkc_6z3cXQ4RI",authDomain:"shrek-s-maze-59835.firebaseapp.com",projectId:"shrek-s-maze-59835",storageBucket:"shrek-s-maze-59835.appspot.com",messagingSenderId:"830984947424",appId:"1:830984947424:web:b268b898f6b9e8c6503285",measurementId:"G-GQMS0WZT37"},O=M(D),S=T(O);let p="start",l=1,d=0,a=0,y;const u=document.querySelector(".maze"),b=document.querySelectorAll(".maze__wall"),w=document.querySelector(".modal"),k=document.querySelector(".maze__audioplayer"),m=document.querySelector(".maze__start"),h=document.querySelector(".maze__finish"),v=document.querySelector(".maze__wall--2"),C=document.querySelector(".modal__title"),i=document.querySelector(".modal__button"),f=document.getElementById("tens"),g=document.getElementById("seconds"),N=document.querySelector(".modal__button--scoreboard"),P=document.querySelector(".scoreboard-modal__close-button"),I=document.querySelector(".scoreboard-modal"),$={level1:{1:"1 / 1 / 7 / 3",2:"4 / 3 / 7 / 5",3:"2 / 6 / 8 / 8",4:"2 / 4 / 3 / 6"},level2:{2:"1 / 5 / 6 / 8",1:"1 / 8 / 4 / 9",3:"3 / 9 / 4 / 10",4:"5 / 9 / 11 / 11",5:"6 / 7 / 10 / 8",6:"2 / 3 / 11 / 4",7:"7 / 4 / 8 / 6",8:"1 / 1 / 5 / 2",9:"6 / 2 / 9 / 3",10:"9 / 5 / 10 / 7"},level3:{1:"18 / 4 / 19 / 7",2:"13 / 1 / 18 / 7",3:"1 / 1 / 13 / 3",4:"20 / 4 / 21 / 9",5:"1 / 3 / 3 / 18",6:"10 / 8 / 20 / 9",7:"10 / 4 / 12 / 8",8:"4 / 4 / 10 / 5",9:"4 / 5 / 5 / 16",10:"15 / 9 / 18 / 13",11:"14 / 10 / 15 / 13",12:"6 / 6 / 7 / 17",13:"8 / 6 / 9 / 17",14:"3 / 17 / 19 / 18",15:"10 / 10 / 13 / 16",16:"19 / 10 / 20 / 19",17:"14 / 14 / 18 / 17",18:"6 / 20 / 21 / 21",19:"9 / 18 / 18 / 19",20:"4 / 19 / 6 / 21"}},_={1:{gridColsRows:"repeat(7, 1fr)",background:"url('./assets/images/castle.webp')",pathColor:"#723305",wallsColor:"rgba(80, 5, 5, 0.822)",startArea:"7 / 1 / 8 / 2",finishArea:"1 / 7 / 2 / 8",startIcon:"url('./assets/images/dragon.webp')",finishIcon:"url('./assets/images/donkey.webp')",audioSource:"./assets/sounds/level1.mp3"},2:{gridColsRows:"repeat(10, 1fr)",background:"url('./assets/images/swamp.webp')",pathColor:"#aa5e27",wallsColor:"rgb(13, 83, 4)",startArea:"9 / 1 / 11 / 3",finishArea:"1 / 9 / 3 / 11",startIcon:"url('./assets/images/donkey.webp')",finishIcon:"url('./assets/images/shrek.webp')",audioSource:"./assets/sounds/level2.mp3"},3:{gridColsRows:"repeat(20, 1fr)",background:"url('./assets/images/far-far-away.webp')",wallsColor:"#2d303d",startArea:"18 / 1 / 21 / 4",finishArea:"1 / 18 / 4 / 21",startIcon:"url('./assets/images/shrek.webp')",finishIcon:"url('./assets/images/fiona.webp')",audioSource:"./assets/sounds/level3.mp3"}};q(1);z();i.addEventListener("click",()=>{K(),l===1?v.textContent="Click the Dragon to start the game":v.textContent="",(i.textContent==="Play Again"||i.textContent==="Yeyy, play again")&&(clearInterval(y),a=0,d=0,f.innerHTML="00",g.innerHTML="00",l=1),w.style.display="none",q(l)});u.addEventListener("mouseleave",E);b.forEach(e=>{e.addEventListener("mouseover",E)});m.addEventListener("click",()=>{p="go",m.textContent="GO!",setTimeout(()=>{m.textContent="",v.textContent=""},1e3),clearInterval(y),y=setInterval(j,10)});h.addEventListener("mouseover",()=>{p==="go"&&(p="finished",k.src=_[l].audioSource,k.play(),W(l),clearInterval(y),w.style.display="block")});N.addEventListener("click",()=>{I.style.display="block"});P.addEventListener("click",()=>{I.style.display="none"});document.addEventListener("contextmenu",function(e){e.preventDefault()});document.addEventListener("keydown",function(e){e.key==="F12"&&(e.preventDefault(),alert("Use of developer tools is blocked on this page."))});function q(e){const t=_[e];document.body.style.backgroundImage=t.background,u.style.backgroundColor=t.pathColor,u.style.gridTemplateColumns=t.gridColsRows,u.style.gridTemplateRows=t.gridColsRows,b.forEach(r=>{r.style.backgroundColor=t.wallsColor}),m.style.gridArea=t.startArea,m.style.backgroundImage=t.startIcon,h.style.gridArea=t.finishArea,h.style.backgroundImage=t.finishIcon,G(e)}function G(e){const t=$[`level${e}`];b.forEach(r=>{r.style.display="none"}),Object.keys(t).forEach(r=>{const n=document.querySelector(`.maze__wall--${r}`);n&&(n.style.display="block",n.style.gridArea=t[r])})}function E(){p==="go"&&(b.forEach(e=>{e.style.backgroundColor="#bf0000"}),setTimeout(()=>{p="start",u.classList.remove("dead"),l=1},500),w.style.display="block",C.textContent="Shrek's Maze",i.textContent="Play Again",l=1,clearInterval(y))}function W(e){if(e<3)C.textContent="Good Job",i.textContent="Next Level",l++;else{C.textContent="You won",i.textContent="Yeyy, play again";let t=prompt("Congratulations! Enter your name (max 13 characters):");if(t){t=t.substring(0,13);const r=`${g.innerHTML}:${f.innerHTML}`;Y(t,r),z()}}}function Y(e,t){const r=x(L(S,"scores"));A(r,{name:e,time:t}).then(()=>{}).catch(n=>{console.error("Error adding score: ",n)})}function z(){const e=R(L(S,"scores"),F("time","asc"),H(5));B(e).then(t=>{const r=document.querySelector(".scoreboard-modal__content div");r.innerHTML="";for(let n=0;n<t.docs.length;n++){const s=t.docs[n].data(),c=document.createElement("p");c.className="scoreboard-modal__player-score",c.textContent=`${n+1}. ${s.name} - ${s.time}`,r.appendChild(c)}})}function j(){a++,a<=9&&(f.innerHTML="0"+a),a>9&&(f.innerHTML=a),a>99&&(d++,g.innerHTML="0"+d,a=0,f.innerHTML="00"),d>9&&(g.innerHTML=d)}function K(){const e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}
